/* -- DO NOT REMOVE --
 * jQuery DCalendar 1.1 and DCalendar Picker 1.1 plugin
 * 
 * Author: Dionlee Uy
 * Email: dionleeuy@gmail.com
 *
 * Date: Sat Mar 2 2013
 *
 * @requires jQuery
 * -- DO NOT REMOVE --
 */
if("undefined"==typeof jQuery)throw new Error("DCalendar.Picker: This plugin requires jQuery");+function(t){Date.prototype.getDays=function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()};var e=["January","February","March","April","May","June","July","August","September","October","November","December"],a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=function(d,r){function n(){var e=o(s.options.format),a=t.Event("selectdate",{date:e});s.calendar.trigger(a)}function o(t){var d=new Date(s.selected),r=d.getDate(),n=d.getMonth(),o=d.getFullYear();return t.replace(/(yyyy|yy|mmmm|mmm|mm|m|dd|d)/gi,function(t){switch(t.toLowerCase()){case"d":return r;case"dd":return 10>r?"0"+r:r;case"m":return n+1;case"mm":return 10>n+1?"0"+(n+1):n+1;case"mmm":return a[n];case"mmmm":return e[n];case"yy":return o.toString().substr(2,2);case"yyyy":return o}})}function h(t){var e=new Date(s.date);"days"==s.viewMode?e.setMonth("next"==t?e.getMonth()+1:e.getMonth()-1):e.setFullYear("next"==t?e.getFullYear()+1:e.getFullYear()-1),e.setDate(1),s.date=e,s.create(s.viewMode)}this.calendar=t(d),this.today=new Date,this.date=this.today,this.viewMode="days",this.options=r,this.selected=this.date.getMonth()+1+"/"+this.date.getDate()+"/"+this.date.getFullYear(),"calendar"==r.mode?this.tHead=t('<thead><tr><th id="prev">&lsaquo;</th><th colspan="5" id="currM"></th><th id="next">&rsaquo;</th></tr><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead>'):"datepicker"==r.mode&&(this.tHead=t('<thead><tr><th id="prev">&lsaquo;</th><th colspan="5" id="currM"></th><th id="next">&rsaquo;</th></tr><tr><th>S</th><th>M</th><th>T</th><th>W</th><th>T</th><th>F</th><th>S</th></tr></thead>')),this.tHead.find("#currM").text(e[this.today.getMonth()]+" "+this.today.getFullYear()),this.calendar.prepend(this.tHead);var s=this;this.calendar.on("click","#next",function(){h("next")}).on("click","#prev",function(){h("prev")}).on("click","#today",function(){s.viewMode="days";var t=new Date(s.date),e=new Date(s.today);t.toString()!=e.toString()&&(s.date=e),s.create("days")}).on("click",".date",function(){return s.selected=s.date.getMonth()+1+"/"+t(this).text()+"/"+s.date.getFullYear(),"datepicker"==s.options.mode&&(s.calendar.find("td").removeClass("selected"),t(this).addClass("selected")),n(),!0}).on("click",".pMDate",function(){return s.selected=(0==s.date.getMonth()?"12":s.date.getMonth())+"/"+t(this).text()+"/"+(0==s.date.getMonth()?s.date.getFullYear()-1:s.date.getFullYear()),"datepicker"==s.options.mode&&(s.calendar.find("td").removeClass("selected"),t(this).addClass("selected")),n(),!0}).on("click",".nMDate",function(){return s.selected=(s.date.getMonth()+2==13?"1":s.date.getMonth()+2)+"/"+t(this).text()+"/"+(s.date.getMonth()+2==13?s.date.getFullYear()+1:s.date.getFullYear()),"datepicker"==s.options.mode&&(s.calendar.find("td").removeClass("selected"),t(this).addClass("selected")),n(),!0}).on("click","#currM",function(){s.viewMode="months",s.create(s.viewMode)}).on("click",".month",function(e){s.viewMode="days";{var a=new Date(s.date);s.calendar.find("#currM").text()}a.setMonth(t(e.currentTarget).attr("num")),s.date=a,s.create(s.viewMode)}),this.create(this.viewMode)};r.prototype={constructor:r,create:function(r){var n=this,o=[],h=t("<tbody></tbody>"),s=new Date(n.date),i=n.date.getDays(),c=1,l=1,u=n.selected.split("/");if(n.calendar.empty(),"days"==r){"calendar"==n.options.mode?n.tHead=t('<thead><tr><th id="prev">&lsaquo;</th><th colspan="5" id="currM"></th><th id="next">&rsaquo;</th></tr><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead>'):"datepicker"==n.options.mode&&(n.tHead=t('<thead><tr><th id="prev">&lsaquo;</th><th colspan="5" id="currM"></th><th id="next">&rsaquo;</th></tr><tr><th>S</th><th>M</th><th>T</th><th>W</th><th>T</th><th>F</th><th>S</th></tr></thead>')),n.tHead.find("#currM").text(e[n.date.getMonth()]+" "+n.date.getFullYear()),n.calendar.append(n.tHead),console.log(u);for(var p=1;6>=p;p++){for(var y=[t("<td></td>"),t("<td></td>"),t("<td></td>"),t("<td></td>"),t("<td></td>"),t("<td></td>"),t("<td></td>")];i>=c;){s.setDate(c);var g=s.getDay();if(c==n.today.getDate()&&s.getMonth()==n.today.getMonth()&&s.getFullYear()==n.today.getFullYear()?y[g].attr("id","currDay"):"datepicker"==n.options.mode&&c==u[1]&&s.getMonth()==u[0]-1&&s.getFullYear()==u[2]&&y[g].addClass("selected"),1==p&&0==g)break;if(!(6>g)){y[g].html("<span>"+c++ +"</span>").addClass("date");break}y[g].html("<span>"+c++ +"</span>").addClass("date")}if(1==p||p>4){var f=new Date(n.date);f.setMonth(f.getMonth()+(1==p?-1:1));for(var M=f.getDays(),m=1==p?6:0;1==p?m>=0:6>=m;1==p?m--:m++)""==y[m].text()&&(y[m].html("<span>"+(1==p?M--:l++)+"</span>").addClass(1==p?"pMDate":"nMDate"),"datepicker"==n.options.mode&&(1==p?M+1:l-1)==u[1]&&f.getMonth()==u[0]-1&&f.getFullYear()==u[2]&&y[m].addClass("selected"))}o.push(y)}t.each(o,function(e,a){for(var d=t("<tr></tr>"),r=a.length,e=0;r>e;e++)d.append(a[e]);h.append(d)});var v="Today: "+d[n.today.getDay()]+", "+e[n.today.getMonth()]+" "+n.today.getDate()+", "+n.today.getFullYear();h.append('<tr><td colspan="7" id="today">'+v+"</td></tr>").appendTo(n.calendar)}else{this.tHead=t('<thead><tr><th id="prev">&lsaquo;</th><th colspan="2" id="currM"></th><th id="next">&rsaquo;</th></tr>'),n.tHead.find("#currM").text(n.date.getFullYear()),n.tHead.appendTo(n.calendar);for(var D=0,p=0;3>p;p++){for(var w=t("<tr></tr>"),F=0;4>F;F++){var k=t('<td align="center"></td>'),x=t('<span class="month" num="'+D+'">'+a[D]+"</span>");k.append(x).appendTo(w),D++}h.append(w)}var v="Today: "+d[n.today.getDay()]+", "+e[n.today.getMonth()]+" "+n.today.getDate()+", "+n.today.getFullYear();h.append('<tr><td colspan="4" id="today">'+v+"</td></tr>").appendTo(n.calendar)}}},t.fn.dcalendar=function(e){return t(this).each(function(a,d){var n=this,o=t(n),h=t(n).data("dcalendar"),s=t.extend({},t.fn.dcalendar.defaults,o.data(),"object"==typeof e&&e);h||o.data("dcalendar",h=new r(this,s)),"string"==typeof e&&h[e]()})},t.fn.dcalendar.defaults={mode:"calendar",format:"mm/dd/yyyy"},t.fn.dcalendar.Constructor=r,t.fn.dcalendarpicker=function(e){return t(this).each(function(){var a=t(this),d=t('<table class="calendar"></table>'),r=!1,n=!1;a.wrap(t('<div class="datepicker" style="display:inline-block;position:relative;"></div>')),d.css({position:"absolute",left:0,display:"none","box-shadow":"0 0 4px rgba(0,0,0,0.15)",width:"230px"}).appendTo(a.parent()),e?(e.mode="datepicker",d.dcalendar(e)):d.dcalendar({mode:"datepicker"}),d.hover(function(){r=!0},function(){r=!1}).on("click",function(){n?(n=!1,t(this).hide()):a.focus()}).on("selectdate",function(e){a.val(e.date).trigger("onchange"),a.trigger(t.Event("dateselected",{date:e.date,elem:a})),n=!0}),a.on("keydown",function(t){return t.which?!1:void 0}).on("focus",function(){t(".datepicker").find(".calendar").not(d).hide(),d.show()}).on("blur",function(){r||d.hide()})})}}(jQuery);